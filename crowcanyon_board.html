<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="http://cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
    <link rel="stylesheet" href="./css/crowcanyon/crowcanyon_board.css">
    <link rel="stylesheet" href="./css/crowcanyon/hf.css">
    <script defer src="./js/crowcanyon/hf.js"></script>
    <script defer src="./js/crowcanyon/list.js"></script>
    <script defer src="./js/crowcanyon/crowcanyon_login.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>
<script>
    let sp = ["android", "iphone", "ipad", "macintosh"];
     
    for(let i=0; i<sp.length; i++) {
        if(navigator.userAgent.toLowerCase().match(sp[i])) {
            location.replace("m.crowcanyon_board.html")
        }
    }
    </script>
<body>
    <div id="wrap" style="min-width: 1440px">
    <div class="search_pan">
        <div class="search_close xi-close"></div>
        <div class="search_center">
            <input class="input_search" type="search" placeholder="SEARCH">
            <p>ê²€ìƒ‰ì–´ ì…ë ¥í›„ì— ì—”í„°ë¥¼ ëˆ„ë¥´ì„¸ìš”.</p>
        </div>
    </div>
    <div class="top_banner">
        <div class="tb top_banner1"><a href="#">To my bestie For my bestie</a></div>
        <div class="tb top_banner2"><a href="#">ë§¤ì¹˜í”„ë¼ì´ìŠ¤ with ì••êµ¬ì • ì‡¼ë£¸</a></div>
        <div class="tb top_banner3"><a href="#">íšŒì› í˜œíƒ! ì „ì œí’ˆ ìƒì‹œ 5% í• ì¸!</a></div>
        <div class="tb top_banner4"><a href="#">ìŠ¤ì½”í”„ì„œìš¸ í™ˆí˜ì´ì§€ ë°”ë¡œê°€ê¸°</a></div>
        <div class="close_btn">X</div>
    </div>
    <div class="header" style="min-width: 1440px">
        <div class="logo"><a href="./index.html">ë¡œê³ </a></div>
        <ul class="menu">
            <li class="menu_li">
                <a href="#">ABOUT</a>
                <ul class=" pan menu_pan1">
                    <li><a href="#">STORY</a></li>
                    <li><a href="#">COMPANY</a></li>
                    <li><a href="#">CONTACT</a></li>
                    <li><a href="#">STOCKIST</a></li>
                </ul>
            </li>
            <li class="menu_li">
                <a href="#">SHOP</a>
                <ul class=" pan menu_pan2">
                    <li><a href="#">ì¬ì…ê³ </a></li>
                    <li><a href="crowcanyon_2.html?cateNo=0">ì»µ</a></li>
                    <li><a href="crowcanyon_2.html?cateNo=1">ë³´ìš¸</a></li>
                    <li><a href="crowcanyon_2.html?cateNo=2">í”Œë ˆì´íŠ¸</a></li>
                    <li><a href="crowcanyon_2.html?cateNo=3">í‚¤ì¹œì›¨ì–´</a></li>
                    <li><a href="#">ì„ ë¬¼ì„¸íŠ¸</a></li>
                    <li><a href="#">êµ¿ì¦ˆ</a></li>
                    <li><a href="#">OUTLET</a></li>
                </ul>
            </li>
            <li class="menu_li">
                <a href="#">RECOMMEND</a>
                <ul class=" pan menu_pan3">
                    <li><a href="#">í¬ë¡œìš°ì›¨ì–´</a></li>
                    <li><a href="#">ì‚°ëœ»í•œ ë´„ ë§ì´</a></li>
                    <li><a href="#">ë°˜ë ¤ë™ë¬¼ê³¼ í•¨ê»˜ğŸ¾</a></li>
                    <li><a href="#">ì§‘ë“¤ì´ ì„ ë¬¼</a></li>
                </ul>
            </li>
            <li class="menu_li">
                <a href="#">JOURNAL</a>
                <ul class=" pan menu_pan4">
                    <li><a href="#">MAGAZINE</a></li>
                    <li><a href="#">ARCHIVE</a></li>
                </ul>
            </li>
            <li class="menu_li">
                <a href="#">COMMUNITY</a>
                <ul class=" pan menu_pan5">
                    <li><a href="#">NOTICE</a></li>
                    <li><a href="#">Q&A</a></li>
                    <li><a href="#">REVIEW</a></li>
                    <li><a href="#"><i class="xi-instagram"></i></a></li>
                </ul>
            </li>
        </ul>

        <div class="top_btn">
            <i class="search xi-search xi-2x"></i>
            <a href="#" class="basket"><img src="./img/crowcanyon/page1/basket.png" alt=""></a>
            <a href="#"><i class="ham xi-bars xi-2x"></i></a>
        </div>
    </div>
    <div class="ham_pan">
        <i class="ham_close_btn xi-close"></i>
        <ul class="ham_ul">
            <li class="ham_li"><a href="./crowcanyon_login.html">ë¡œê·¸ì¸</a></li>
            <li class="ham_li"><a href="#">ì¥ë°”êµ¬ë‹ˆ</a></li>
            <li class="ham_li"><a href="#">ì£¼ë¬¸ì¡°íšŒ</a></li>
            <li class="ham_li"><a href="#">ë§ˆì´ì‡¼í•‘</a></li>
            <li class="ham_li"><a href="#">ìµœê·¼ìƒí’ˆ</a></li>
            <li class="ham_li"><a href="#">ì¿ í°ì¦ì •</a></li>
        </ul>
    </div>
    <div class="content">
            <div class="login">ê²Œì‹œë¬¼</div>
            <form action="" id="frm">
                <input type="text" name="bno" value="${boardDto.bno}" readonly >
                <input type="text" name="title" id="title" value="${boardDto.title}" ${mode=="new"?"":"readonly"} >
    
                <div id="writer" ><b>${boardDto.writer}</b></div>
    
                <textarea name="content" id="content" ${mode=="new"?"":"readonly"}>${boardDto.content}</textarea>
                
                <%-- íŒŒì¼ ì—…ë¡œë“œ--%>
                            <input type="file" name="f_file"  multiple="multiple">
                            <br /><br />
                            
                <c:if test="${mode == 'new'}" >
                    <button type="button"  class="btn" id="btn_write">ì €ì¥</button>
                </c:if>
    
                <c:if test="${mode == 'new'}" >
                    <button type="button"  class="btn" id="btn_write">ê¸€ì“°ê¸°</button>
                </c:if>
    
                <c:if test="${mode != 'new' && boardDto.writer.equals(userId)}">
                    <button type="button"  class="btn" id="btn_modify">ìˆ˜ì •</button>
                    <button type="button"  class="btn" id="btn_del">ì‚­ì œ</button>
                </c:if>
    
    
                <button type="button"  class="btn" id="btn_list">ëŒì•„ê°€ê¸°</button>
            </form>
    
            <hr />
    
            <div id="comment_area" >
    
                <jsp:include page="comment.jsp" flush="false" />
    <%--            flush: ì§€ì •í•œ jsp í˜ì´ì§€ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— ì¶œë ¥ ë²„í¼ë¥¼ í”ŒëŸ¬ì§€í• ë¦¬ ì—¬ë¶€ ê²°ì •--%>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    $(document).ready(function(){

        $('#btn_list').on('click', function(){

            let tmp_param = get_uri_info();
            location.href = "<c:url value='/board/list' />?page=${page}&pageSize=${pageSize}&option=${param.option}&keyword=${param.keyword}";
        })

        $('#btn_write').on('click',function(){
            // ìœ íš¨ì„± ê²€ì‚¬ - title, content ë¹ˆì¹¸ ì²´í¬
            if($('#title').val().trim() == "") {
                alert("ì œëª©ì„ ì…ë ¥í•˜ì‹œì˜¤");
                $('#title').focus();
                // return;
            }
            else if($('#content').val().trim() == "") {
                alert("ë‚´ìš©ì„ ì…ë ¥í•˜ì‹œì˜¤");
                $('#content').focus();
                // return;
            }
            else {
                let frm = $("#frm");
                frm.attr("action", "<c:url value='/board/write'/>")
                frm.attr("method", "POST");
                frm.submit();
            }
        });


        $('#btn_modify').on('click', function(){
            let isReadonly = $('#title').attr("readonly");

            // 1. ê¸°ì¡´ ì½ê¸° ìƒíƒœì¼ë•Œ 'ìˆ˜ì •'ë²„íŠ¼ ëˆ„ë¥¸ ê²½ìš°
            //  #page_mode, #title, #content ì˜ readonly ì‚­ì œ
            if(isReadonly == "readonly") {
                $('#page_mode').text("ê²Œì‹œë¬¼ ìˆ˜ì •")
                $('#title').attr('readonly', false);
                $('#content').attr('readonly', false);
                $('#btn_modify').text('í™•ì¸');
                $('#title').focus();

                return;
            }

            // 2. ìˆ˜ì • ìƒíƒœì¼ë•Œ ë˜ 'ìˆ˜ì •' ë²„íŠ¼ ëˆ„ë¥¸ ê²½ìš°
            let tmp_param = get_uri_info();

            let frm = $("#frm");
            frm.attr("action", "<c:url value='/board/modify'/>?"+tmp_param)
            frm.attr("method", "post");
            frm.submit();
        });

        function get_uri_info() {
            // url ê°’ ëª¨ë‘ ê°€ì ¸ì˜¤ê¸°
            // console.log(location.href);
            const searchParam = new URLSearchParams(location.search);
            // [ bno=224,  page=1,  pageSize=10,  option=,  keyword= ]
            // alert(searchParam.size); // 5
            let tmp_param=""; // bno=224&page=1&pageSize=10&option=&keyword=&
            for(const param of searchParam) { // page=1 => [page, 1]
                console.log(param);
                tmp_param += param[0]+"="+param[1]+"&"; // page=1&
                // bno=224&page=1&pageSize=10&option=&keyword=
            }
            console.log(tmp_param);

            return tmp_param;
        }

        $('#btn_del').on("click", function(){
            if(!confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

            let tmp_param = get_uri_info();

            // get ë°©ì‹
            // location.href = "/board/remove?"+tmp_param;

            // post , get ë‹¤ ë¨
            let frm = $("#frm");
            frm.attr("action", "<c:url value='/board/remove'/>?"+tmp_param)
                    // /app/board/remove?tmp_param
            frm.attr("method", "post");
            // frm.attr("method", "get");
            frm.submit();

        });
    })
</script>
</html>